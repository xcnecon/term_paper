---
title: "Predicting the Next-Quarter Corporate Profit with Vector Autoregression"
format: 
    pdf:
        documentclass: article 
        number-sections: true
        margin-top: 1in
        margin-bottom: 1in
        margin-left: 1in
        margin-right: 1in
        linestretch:  1.2
        fontsize: 10pt
        fig-pos: "H"
execute: 
  echo: false
  warning: false     
author: "Chenning Xu"        
bibliography: reference.bib
---

# Introduction
In capitalism, profits motivate firms to employ labor and produce output for sale [@veblen_theory_1904]. Due to the fundamental uncertainty of the future, firms expect future profits and make investments accordingly, often disproportionately influenced by recent sales and profit conditions [@keynes_general_1936]. Changes in current and expected future corporate profits significantly affect economic outlooks. Additionally, the valuation of equity in firms is often based on the discounted value of future profits. Lenders extend loans to firms based on their earnings capacity, and the soundness of these loans depends on the profits firms realize in the future [@minsky_financial-instability_1982]. Therefore, profit is seen as one of the most critical concepts in economics and finance. The Kalecki-Levy profit equation is an accounting identity that shows how aggregate corporate profit is determined by economic variables such as investment and government deficits [@levy_where_2008]. This project aims to use the variables in the Kalecki-Levy equation to build a predictive model for the next-quarter corporate profit.

# Theoretical Background
## Kalecki-Levy Profit Equation
@levy_where_2008 presented a stylized Kalecki-Levy equation for open economies (signs of RHS variables are adjusted here according to the National Income and Product Accounts (NIPA) accounting convention):
$$
\begin{aligned}
\text{Profit after tax} &= \text{Net Investment} \\
                        &\phantom{=} - \text{Personal Saving} \\
                        &\phantom{=} + \text{Foreign Saving} \\
                        &\phantom{=} - \text{Government Saving}\\
                        &\phantom{=} + \text{Net Dividend}
\end{aligned}
$$ {#eq-pq}

The Kalecki-Levy equation, as an accounting identity, is tautologically true. Here is the proof:
$$ I = S = PS + CS + FS + GS$$
$$ I = PS + (CP - ND) + FS + GS$$
$$ CP = I - PS - FS - GS + ND$$
where *I* is net investment (gross investment - depreciation), *S* is net saving, *PS* is personal saving, *CS* is corporate saving, *FS* is foreign saving, *GS* is government saving, *CP* is net corporate profit, and *ND* is net dividend (total dividend excluding dividends paid to firms). Since in the NIPA account, *Foreign Saving* is recorded as a negative figure, after flipping the sign of it, we get @eq-pq. For technical details, please refer to @bea_nipa_2024.

Since the above analysis is purely an accounting analysis, it does not imply any behavioral relations or causality. However, Minsky argued that it is the RHS that determines corporate profit, not vice versa. The straightforward explanation for investment causing profit is that firms cannot control future profit but can determine how much they invest in the next quarter based on their expectations of future economic conditions. For a detailed analysis, please refer to Minsky (1986, Chapter 2).

## Research Motivation
Given the Kalecki-Levy framework for profit determination, a key motivation of this study is to explore how the relationships defined in these identities might serve as practical tools for prediction, rather than merely theoretical constructs. While the original equations hold by definition, leveraging them in a predictive model allows us to investigate whether observable trends in the determinants of profit—and profit itself—can reliably signal changes in future corporate profit.

For example, does a consistent increase in net investment over the past year suggest momentum that could continue into the next quarter, thereby boosting profits? Similarly, could a high personal saving rate over several quarters indicate an upcoming decline, indirectly increasing corporate profit? Shifting focus to prediction invites us to examine not only if these relationships hold as identities but if they possess empirical stability and value in forecasting applications.

Although prior research, such as @trofimov_determinants_2022, utilized panel VAR to assess the impact of profit determinants on margins—finding a positive effect from trade surpluses and a negative one from government deficits—such studies have not applied these equations in a forward-looking, predictive context. By employing a rolling-window Vector Auto-Regression (VAR) model, this project specifically aims to predict corporate profit for the next quarter. This method leverages both historical values of profit itself and its key determinants, building on the identity to test its predictive utility, as discussed in the next section.


# Data
The quarterly and annual series of corporate profit, personal saving, foreign saving, government saving, and net dividend are collected from NIPA (https://www.bea.gov/itable/national-gdp-and-personal-income). The monthly series of the S&P 500 price and earnings are collected from Robert Shiller  
(http://www.econ.yale.edu/~shiller/data.htm). Currently, only the quarterly series of NIPA is explored.

## Exploratory Data Analysis: Identity
:::{#fig-fig1}

![](../../results/eda/identity.png){width=75% fig-align=center}

Identity between Corporate Profit and RHS
:::

This graph shows that the Kalecki-Levy equation holds true in the NIPA. The left graph shows the close relationship between corporate profit and the sum of the RHS. The right graph shows the exact identity between corporate profit and the RHS after adjusting for the statistical discrepancy term in the NIPA. Exploratory data analysis is presented below.

## Exploratory Data Analysis: Stationarity
:::{#fig-fig2}

![](../../results/eda/series.png){width=75% fig-align=center}

Time-Series of the Variables in Kalecki-Levy Equation
:::

This graph shows that all six variables in the Kalecki-Levy equation trend with time and are therefore not stationary. For time series analysis, detrending the variables is necessary.

:::{#fig-fig3}

![](../../results/eda/series_level.png){width=75% fig-align=center}

Detrending the variables - Level change QoQ
:::

:::{#fig-fig4}

![](../../results/eda/series_pct.png){width=75% fig-align=center}

Detrending the variables - % change QoQ

:::

The results of Phillips-Perron unit root tests reject the null hypothesis with p-values under 0.001 for all six variables in both approaches, indicating that they do not follow a random walk. No obvious trend could be observed in both graphs. However, two approaches to detrending come with their advantages and disadvantages.

@fig-fig3 shows the quarter-on-quarter difference of the six variables. For some variables, such as corporate profit, net dividend, foreign saving, and net investment, there appears to be increasing standard deviation. This approach preserves the identity of the six variables, as taking differences does not alter the relative magnitude. Additionally, the magnitude of these variables is preserved.

@fig-fig4 shows the quarter-on-quarter percentage change of the six variables. there appears to be no increasing standard deviation. However,this approach produces highly volatile outcomes, with some changes over 1000%. And when these variables change signs, the percentage change will always be negative, not necessarilly indicating a decline of magnitude. Besides, the information of Kalecki-Levy identity is lost. If the relative magnitude of the RHS variables changes over time, using percentage change may not capture structural shifts.

The problem of increasing standard deviation and difficutlty of capturing structural change could be mitigated by using a smaller training sample in the later rolling-window VAR tests. However, the problem of high volatity and sign changing in the percentage change approach remains an issue. 


# Methodology and Analysis
## VAR and Granger Causality Tests
Vector autoregressions[@bekes_data_2021 page 505] are performed on the entire dataset using both the level difference and percentage difference variables, followed granger causality tests[@noauthor_granger_2024]. The results of using percentage change variables, with eight lags of endogenous variables and time as exogenous variable are presented here. The model in math would be expressed as: 
$$
\begin{aligned}
p_{cp,t} = & \ \alpha_{cp} + \sum_{i=1}^{4} \left( \beta_{cp,cp,i} p_{cp,t-i} + \beta_{cp,ps,i} p_{ps,t-i} + \beta_{cp,gs,i} p_{gs,t-i}\right. \\
           & \ \left. + \beta_{cp,ni,i} p_{ni,t-i} + \beta_{cp,fi,i} p_{fi,t-i} + \beta_{cp,nd,i} p_{nd,t-i} + \gamma_{cp} \cdot \text{date}_t + \epsilon_{cp,t}\right) \\
\end{aligned}
$${#eq-var}

Where: $\alpha_{cp}$ is the intercept for the equation; $\beta_{cp,cp,i}, \beta_{cp,ps,i}, \beta_{cp,gs,i}, \beta_{cp,ni,i}, \beta_{cp,fi,i}, \beta_{cp,nd,i}$ are the coefficients for the lagged values of the endogenous variables at lag $i$; $\gamma_{cp}$ is the coefficient for the exogenous variable (date); $\epsilon_{cp,t}$ is the error term (residual) for $d_{cp,t}$. Due to the length limit and our narrow interest on predicting corporate profit, the equations for other variables are not shown here. 

:::{#tbl-tbl1}

{{< include pct_var.txt >}}

VAR Results

:::

Only the significant coefficients are presented here. The notation L# indicates the number of quarters in the past for the lagged percentage changes. For example, L3.c_ps represents the percentage change in personal saving from three quarters ago.


The results are somewhat complex to interpret. Lagged changes in corporate profit show no correlation with changes in next-quarter profit. Lagged changes in personal saving appear positively correlated with profit changes in the short run but exhibit a negative correlation over a longer horizon. Lagged changes in government saving (typically negative, indicating a deficit) and net investment display positive correlations with profit changes after a delay of at least one year. Foreign saving (usually negative, reflecting a current account deficit) is negatively correlated with profit change in the short run but shows a consistent positive correlation over a longer period. Finally, lagged changes in net dividends seem negatively correlated with profit change in the short run, switching to a positive correlation over a longer horizon.


Given that this model includes six variables with eight lags each (a total of 48 lagged variables), caution is needed when interpreting p-values, despite the use of robust standard errors. The model accounts for approximately 26% of the variation in next-quarter profit change; however, without out-of-sample testing, the risk of overfitting remains.


The Granger causality test (not reported) suggests that, except for net investment, we can reject the null hypothesis that the independent variables do not Granger-cause percentage changes in corporate profit. Interestingly, none of the variables Granger-cause government saving, indicating that it may behave autonomously within our sample.


## Rolling-Window VAR
To mimic real-life prediction process, rolling-window var tests are performed, using smaller sets of training data to predict the next-quarter corproate profit change. This approach mitigates the problem of increasing standard deviation and the risk of structureal changes. Results of tests using both level and percentage chaneg data are reported here. The math formula for the VAR using level difference and more tests of other specifications can be foud in the robustness check section. 

:::{#tbl-tbl2}

{{< include r2.txt >}}

Rolling-Window VAR

:::

@tbl-tbl2 presents results from two rolling-window VAR models and their corresponding control models, which include only lagged changes in corporate profit and time. The "Level 8-100" model uses level differences, 8 lags, and a 100-observation training sample. The R² values for the "Level 8-100" and "Level 4-80" models are notably high, at 0.615 and 0.487, respectively, indicating that these models explained over 61% and 48% of the variation in next-quarter profit changes. Both models significantly outperformed their control models.

Models based on percentage changes underperformed compared to those using level changes, potentially because the structural information from the right-hand side (RHS) variables enhances predictive power, or because percentage changes are too volatile for effective training. Nonetheless, the percentage change models still significantly outperformed their control models. Interestingly, the level control models performed much better than the percentage change control models, suggesting that level differences may indeed provide an advantage in model training.

:::{#fig-fig5}

![](../../results/analysis/prediction.png){width=100% fig-align=center}

Prediction Series
:::

@fig-fig5 displays the prediction series of the four models in @tbl-tbl2 alongside the actual level and percentage change in corporate profit. The two level models appear to capture the increasing standard deviation effectively, while predictions from the percentage models are consistently too stable compared to the actual series. Since predictions of level changes can be easily transformed into percentage change by deviding the prediction by the previous level of corproate profit,  the rolling-window VAR using level differences thus seems preferable to using percentages. Further analysis of the level models will be conducted in the robustness check section.


# Robustness
The above section has demonstrated the considerable predictive power of VAR using variables in the Kalecki-Levy equation, especially when using level difference. This section will present more discussion on the level difference VAR model. 


The math formula for VAR using level difference is similar to @eq-var but it could not have all the five RHS variables due to perfect multi-colinearity. The models reported in @tbl-tbl2 dropped net dividend for its relative stability. The math formular for the two models can be expressed as:
$$
\begin{aligned}
d_{cp,t} = & \ \alpha_{cp} + \sum_{i=1}^{4} \left( \beta_{cp,cp,i} d_{cp,t-i} + \beta_{cp,ps,i} d_{ps,t-i} + \beta_{cp,gs,i} d_{gs,t-i} \right. \\
           & \ \left. + \beta_{cp,ni,i} d_{ni,t-i} + \beta_{cp,fi,i} d_{fi,t-i} + \gamma_{cp} \cdot \text{date}_t + \epsilon_{cp,t} \right) \\
\end{aligned}
$${#eq-var2}

Surprisingly, the granger causality test could not reject the null hypothesis for any of the four variables at 5% significance level. It is possibly due to the heteroskedasticity from increasing standard deviation and the following increased robust standard error. Here another two model using level difference will be presented as a robustness check. These two models will drop net investment instead of net dividend, since in @tbl-tbl2 net investment failed to show granger causality for next-quarter net corporate profit. 

:::{#tbl-tbl2}

{{< include r2_robust.txt >}}

Rolling-Window VAR

:::

The resutls are very similar to the two models in @tbl-tbl2. Still, level 8-100 does better than 4-80, and much better than the two models using pct changes. To show the latter, here the predicted level changes are transformed into pct changes. 

:::{#fig-fig6}

![](../../results/robustness//contrast.png){width=100% fig-align=center}

Comparing transformed level prediction to pct prediction
:::

This comparison shows clearly that the level prediction is capturing more variation of changes in profit than percentage predictions. This is confirmed by the statistics below. 

:::{#tbl-tbl2}

{{< include compare.txt >}}

Comparison between level and percentage prediction
:::

# Conclusion
This project has conducted VAR and granger causality tests to investigate whether the variables in the Kalecki-Levy equation have lead-lag relations, which turned out to be complicated and have no straightforward intepretation. This project designed rolling-window VAR models to mimic real-life prediction process, and gained considerable success. It has shown that using level difference is much more effective than using percentage difference in rolling-window VAR prediction.  

The high $R^2$ of the rolling-window VAR models indicates considerable predictive power for such a model. If simply analyzing past data can yield positive results, combining this approach with external forecasts and macroeconomic insights could produce an even more effective predictive model. The findings from this study demonstrate that approaching corporate profit from a *macro perspective* holds great potential compared to the bottom-up approach, which merely aggregates the expected profits of individual firms.

This project has some limitations. For example, by using a rolling-window model, there is limited information on *how* the lagged variables predict next-quarter corporate profit, aside from their overall effectiveness. Additionally, this project can extend to building models to predict next-year corproate profit, or to predict the next-next quarter corporate profit, which the strength of VAR allows. 


# References